#!/usr/bin/env sh

echo "ğŸ” Ejecutando validaciones pre-commit..."

# Ejecutar linting
echo "ğŸ“ Verificando linting..."
npm run lint
if [ $? -ne 0 ]; then
    echo "âŒ Linting fallÃ³. Corrige los errores antes de hacer commit."
    exit 1
fi

# Ejecutar tests
echo "ğŸ§ª Ejecutando tests..."
npm run test -- --coverage --ci
if [ $? -ne 0 ]; then
    echo "âŒ Tests fallaron. Corrige los errores antes de hacer commit."
    exit 1
fi

# Ejecutar build
echo "ğŸ”¨ Verificando build..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ Build fallÃ³. Corrige los errores antes de hacer commit."
    exit 1
fi

# Verificar vulnerabilidades
echo "ğŸ”’ Verificando vulnerabilidades de seguridad..."
npm audit --audit-level=high
if [ $? -ne 0 ]; then
    echo "âŒ Se encontraron vulnerabilidades de seguridad. Ejecuta 'npm audit fix' antes de hacer commit."
    exit 1
fi

echo "âœ… Todas las validaciones de cÃ³digo pasaron."
echo "ğŸ“ Ahora se validarÃ¡ el formato del mensaje de commit..."
